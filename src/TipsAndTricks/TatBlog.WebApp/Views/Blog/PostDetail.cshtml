@using TatBlog.Core.Entities;
@using TatBlog.WebApp.Models;
@model CommentEditModel

@{
  IList<Comment> comments = ViewBag.Comments as IList<Comment>;

  var post = ViewBag.Post as Post;

  var imageUrlPost = string.IsNullOrWhiteSpace(post.ImageUrl)
      ? "/images/image_1.jpg"
      : $"/{post.ImageUrl}";

  var imageUrlAuthor = string.IsNullOrWhiteSpace(post.Author.ImageUrl)
      ? "/images/user-default.png"
      : $"/{post.Author.ImageUrl}";
}

<div class="container">
  <div class="row">
    <h1>@post.Title</h1>
    <p class="lead">
      <span>
        <i class="fa fa-user-secret"></i>
        <small class="text-secondary">
          Đăng bởi:
        </small>
        <a asp-controller="Blog"
           asp-action="Author"
           asp-route-slug="@post.Author.UrlSlug"
           class="text-decoration-none text-info fw-semibold">
          @post.Author.FullName
        </a>
      </span>
      &emsp;
      <span>
        <i class="fa fa-brands fa-themeisle"></i>
        <small class="text-muted">
          Chủ đề:
        </small>
        <a asp-controller="Blog"
           asp-action="Category"
           asp-route-slug="@post.Category.UrlSlug"
           class="text-decoration-none text-info fw-semibold">
          @post.Category.Name
        </a>
      </span>
      &emsp;
      <span>
        <i class="fa fa-solid fa-eye"></i>
        <span class="text-info fw-semibold">
          @post.ViewCount
        </span>
      </span>
    </p>

    <hr>
    <p class="lead">
      <i class="fa fa-calendar"></i>
      @if (post.ModifiedDate != null)
      {
        <small class="text-muted">
          Cập nhật lần cuối:
        </small>
        @post.PostedDate.ToString()
      }
      else
      {
        <small class="text-muted">
          Ngày đăng:
        </small>
        @post.PostedDate.ToString()
      }
    </p>
    <p class="lead">
      <i class="fa fa-tags"></i>
      <span class="text-muted">Tags:&emsp;</span>
      @if (post.Tags.Count > 0)
      {
        <partial name="_TagList" model="@post.Tags"></partial>
      }
      else
      {
      <p> Bài viết chưa được gắn thẻ</p>
      }
    </p>

    <hr />

    <p class="lead">@post.ShortDescription</p>
    <img src="@imageUrlPost" class="img-responsive">
    <p class="pt-4">@post.Description</p>

    <!-- ======= Comments ======= -->
    <div class="comments">
      <h5 class="comment-title py-3">
        <span>@comments.Count</span> bình luận
      </h5>

      @foreach (var comment in comments)
      {
        <partial name="_CommentItem" model="@comment" />
      }
    </div>

    <!-- End Comments -->
    <partial name="_CommentForm" model="@Model" />




  </div>
</div>
